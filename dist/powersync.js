"use strict";(()=>{var U={};function me(e,t){U[e]=!0,requestAnimationFrame(()=>{U[e]=!1}),t()}var ge={change:e=>{e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))},click:e=>{e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))},input:(e,t)=>{e instanceof HTMLSelectElement?(e.value=t.inputValue,e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))):e instanceof HTMLElement&&e.isContentEditable?(e.textContent=t.inputValue,e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))):((e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)&&(e.value=t.inputValue),e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})))},keydown:(e,t)=>{e.dispatchEvent(new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:t.inputValue}))},keyup:e=>{e.dispatchEvent(new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,key:""}))},pointerdown:(e,t)=>{e.dispatchEvent(new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:t.pointer.x,clientY:t.pointer.y,pointerId:1,pointerType:"touch",isPrimary:!0}))},pointermove:(e,t)=>{e.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:t.pointer.x,clientY:t.pointer.y,pointerId:1,pointerType:"touch",isPrimary:!0}))},pointerup:(e,t)=>{e.dispatchEvent(new PointerEvent("pointerup",{bubbles:!0,cancelable:!0,clientX:t.pointer.x,clientY:t.pointer.y,pointerId:1,pointerType:"touch",isPrimary:!0}))},popstate:e=>{e.dispatchEvent(new PopStateEvent("popstate",{bubbles:!0,cancelable:!0,state:history.state}))},pushState:e=>{history.pushState({},"",window.location.href)},replaceState:e=>{history.replaceState({},"",window.location.href)},reset:e=>{e.dispatchEvent(new Event("reset",{bubbles:!0,cancelable:!0}))},scroll:(e,t)=>{e instanceof HTMLElement?e.scrollTop=t.scroll.y:e instanceof Document?document.documentElement.scrollTop=t.scroll.y:e instanceof Window&&e.scrollTo(t.scroll.x,t.scroll.y)},submit:e=>{e.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},touchend:e=>{e.dispatchEvent(new TouchEvent("touchend",{bubbles:!0,cancelable:!0,touches:[],targetTouches:[],changedTouches:[]}))},touchmove:e=>{e.dispatchEvent(new TouchEvent("touchmove",{bubbles:!0,cancelable:!0,touches:[],targetTouches:[],changedTouches:[]}))},touchstart:e=>{e.dispatchEvent(new TouchEvent("touchstart",{bubbles:!0,cancelable:!0,touches:[],targetTouches:[],changedTouches:[]}))}};function Z({type:e,params:t}){let r=ge[e];if(r){let a=window;t.selector&&(a=document.querySelector(t.selector)??window),me(e,()=>{r(a,t)})}}function Te(e,t,r){fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJtZXJjdXJlIjp7InB1Ymxpc2giOlsiKiJdfX0.PXwpfIGng6KObfZlcOXvcnWCJOWTFLtswGI5DZuWSK4"},body:new URLSearchParams({topic:t,data:JSON.stringify(r)})})}function we(e){let t=[];for(;e.parentNode;){let r=0,a=0;for(let u=0;u<e.parentNode.children.length;u++){let v=e.parentNode.children[u];v.tagName===e.tagName&&(v===e&&(a=r),r++)}let n=e.tagName.toLowerCase(),l=r>1?`${n}:nth-of-type(${a+1})`:n;t.unshift(l),e=e.parentNode}return t.slice(1).join(" > ")}function Q(e,t,r,a){if(a.target&&!U[a.type]){let n=a.target,l={senderId:r,type:a.type,params:{selector:we(n),inputValue:n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement?n.value:n instanceof HTMLElement&&n.isContentEditable?n.innerHTML.replace(/&nbsp;/g," "):n instanceof HTMLSelectElement?n.value:null,pointer:{x:a.clientX,y:a.clientY},scroll:{x:window.scrollX,y:window.scrollY}}};Te(e,t,l)}}var ee=11;function xe(e,t){var r=t.attributes,a,n,l,u,v;if(!(t.nodeType===ee||e.nodeType===ee)){for(var E=r.length-1;E>=0;E--)a=r[E],n=a.name,l=a.namespaceURI,u=a.value,l?(n=a.localName||n,v=e.getAttributeNS(l,n),v!==u&&(a.prefix==="xmlns"&&(n=a.name),e.setAttributeNS(l,n,u))):(v=e.getAttribute(n),v!==u&&e.setAttribute(n,u));for(var A=e.attributes,y=A.length-1;y>=0;y--)a=A[y],n=a.name,l=a.namespaceURI,l?(n=a.localName||n,t.hasAttributeNS(l,n)||e.removeAttributeNS(l,n)):t.hasAttribute(n)||e.removeAttribute(n)}}var C,Ee="http://www.w3.org/1999/xhtml",f=typeof document>"u"?void 0:document,ye=!!f&&"content"in f.createElement("template"),Me=!!f&&f.createRange&&"createContextualFragment"in f.createRange();function Se(e){var t=f.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}function Ae(e){C||(C=f.createRange(),C.selectNode(f.body));var t=C.createContextualFragment(e);return t.childNodes[0]}function Le(e){var t=f.createElement("body");return t.innerHTML=e,t.childNodes[0]}function Ne(e){return e=e.trim(),ye?Se(e):Me?Ae(e):Le(e)}function R(e,t){var r=e.nodeName,a=t.nodeName,n,l;return r===a?!0:(n=r.charCodeAt(0),l=a.charCodeAt(0),n<=90&&l>=97?r===a.toUpperCase():l<=90&&n>=97?a===r.toUpperCase():!1)}function He(e,t){return!t||t===Ee?f.createElement(e):f.createElementNS(t,e)}function Oe(e,t){for(var r=e.firstChild;r;){var a=r.nextSibling;t.appendChild(r),r=a}return t}function K(e,t,r){e[r]!==t[r]&&(e[r]=t[r],e[r]?e.setAttribute(r,""):e.removeAttribute(r))}var te={OPTION:function(e,t){var r=e.parentNode;if(r){var a=r.nodeName.toUpperCase();a==="OPTGROUP"&&(r=r.parentNode,a=r&&r.nodeName.toUpperCase()),a==="SELECT"&&!r.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),r.selectedIndex=-1)}K(e,t,"selected")},INPUT:function(e,t){K(e,t,"checked"),K(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var r=t.value;e.value!==r&&(e.value=r);var a=e.firstChild;if(a){var n=a.nodeValue;if(n==r||!r&&n==e.placeholder)return;a.nodeValue=r}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var r=-1,a=0,n=e.firstChild,l,u;n;)if(u=n.nodeName&&n.nodeName.toUpperCase(),u==="OPTGROUP")l=n,n=l.firstChild;else{if(u==="OPTION"){if(n.hasAttribute("selected")){r=a;break}a++}n=n.nextSibling,!n&&l&&(n=l.nextSibling,l=null)}e.selectedIndex=r}}},M=1,ne=11,ae=3,re=8;function g(){}function De(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}function Pe(e){return function(r,a,n){if(n||(n={}),typeof a=="string")if(r.nodeName==="#document"||r.nodeName==="HTML"||r.nodeName==="BODY"){var l=a;a=f.createElement("html"),a.innerHTML=l}else a=Ne(a);else a.nodeType===ne&&(a=a.firstElementChild);var u=n.getNodeKey||De,v=n.onBeforeNodeAdded||g,E=n.onNodeAdded||g,A=n.onBeforeElUpdated||g,y=n.onElUpdated||g,de=n.onBeforeNodeDiscarded||g,L=n.onNodeDiscarded||g,pe=n.onBeforeElChildrenUpdated||g,fe=n.skipFromChildren||g,Y=n.addChild||function(i,s){return i.appendChild(s)},X=n.childrenOnly===!0,T=Object.create(null),N=[];function H(i){N.push(i)}function z(i,s){if(i.nodeType===M)for(var d=i.firstChild;d;){var c=void 0;s&&(c=u(d))?H(c):(L(d),d.firstChild&&z(d,s)),d=d.nextSibling}}function O(i,s,d){de(i)!==!1&&(s&&s.removeChild(i),L(i),z(i,d))}function B(i){if(i.nodeType===M||i.nodeType===ne)for(var s=i.firstChild;s;){var d=u(s);d&&(T[d]=s),B(s),s=s.nextSibling}}B(r);function _(i){E(i);for(var s=i.firstChild;s;){var d=s.nextSibling,c=u(s);if(c){var o=T[c];o&&R(s,o)?(s.parentNode.replaceChild(o,s),D(o,s)):_(s)}else _(s);s=d}}function ve(i,s,d){for(;s;){var c=s.nextSibling;(d=u(s))?H(d):O(s,i,!0),s=c}}function D(i,s,d){var c=u(s);if(c&&delete T[c],!d){var o=A(i,s);if(o===!1||(o instanceof HTMLElement&&(i=o,B(i)),e(i,s),y(i),pe(i,s)===!1))return}i.nodeName!=="TEXTAREA"?he(i,s):te.TEXTAREA(i,s)}function he(i,s){var d=fe(i,s),c=s.firstChild,o=i.firstChild,w,h,x,I,b;e:for(;c;){for(I=c.nextSibling,w=u(c);!d&&o;){if(x=o.nextSibling,c.isSameNode&&c.isSameNode(o)){c=I,o=x;continue e}h=u(o);var k=o.nodeType,m=void 0;if(k===c.nodeType&&(k===M?(w?w!==h&&((b=T[w])?x===b?m=!1:(i.insertBefore(b,o),h?H(h):O(o,i,!0),o=b,h=u(o)):m=!1):h&&(m=!1),m=m!==!1&&R(o,c),m&&D(o,c)):(k===ae||k==re)&&(m=!0,o.nodeValue!==c.nodeValue&&(o.nodeValue=c.nodeValue))),m){c=I,o=x;continue e}h?H(h):O(o,i,!0),o=x}if(w&&(b=T[w])&&R(b,c))d||Y(i,b),D(b,c);else{var F=v(c);F!==!1&&(F&&(c=F),c.actualize&&(c=c.actualize(i.ownerDocument||f)),Y(i,c),_(c))}c=I,o=x}ve(i,o,h);var q=te[i.nodeName];q&&q(i,s)}var p=r,P=p.nodeType,j=a.nodeType;if(!X){if(P===M)j===M?R(r,a)||(L(r),p=Oe(r,He(a.nodeName,a.namespaceURI))):p=a;else if(P===ae||P===re){if(j===P)return p.nodeValue!==a.nodeValue&&(p.nodeValue=a.nodeValue),p;p=a}}if(p===a)L(r);else{if(a.isSameNode&&a.isSameNode(p))return;if(D(p,a,X),N)for(var $=0,be=N.length;$<be;$++){var J=T[N[$]];J&&O(J,J.parentNode,!1)}}return!X&&p!==r&&r.parentNode&&(p.actualize&&(p=p.actualize(r.ownerDocument||f)),r.parentNode.replaceChild(p,r)),p}}var Ie=Pe(xe),ie=Ie;var V={};function G(){V={},document.querySelectorAll('link[rel="stylesheet"]').forEach(e=>{e instanceof HTMLLinkElement&&e.href&&(V[new URL(e.href,location.origin).pathname]=e)})}function ke(e){for(let t in V)t==e.replace(/tmp\./,"")&&(V[t].href=`${e}?v=${Date.now()}`)}function Ue(e){document.querySelectorAll("script[src]").forEach(t=>{if(new URL(t.src,location.origin).pathname===e.replace(/tmp\./,"")){let a=document.createElement("script");Array.from(t.attributes).forEach(n=>{a.setAttribute(n.name,n.value)}),a.src=`${e}?v=${Date.now()}`,t.replaceWith(a)}})}async function Ce(e){let t=await fetch(`${e}?v=${Date.now()}`).then(n=>n.text()),a=new DOMParser().parseFromString(t,"text/html");ie(document.documentElement,a.documentElement,{onBeforeElUpdated:(n,l)=>{if(n.hasAttribute("data-component"))return!1;if(n.hasAttribute("id"))switch(n.tagName){case"INPUT":l.value=n.value,l.checked=n.checked;break;case"TEXTAREA":l.value=n.value;break;case"SELECT":l.value=n.value;break;case"OPTION":l.selected=n.selected;break}return document.activeElement===n?(setTimeout(()=>n.focus(),0),n.tagName==="BODY"):!0}}),G()}function se(e){switch(e.type){case"css":ke(e.params.filename);break;case"html":Ce(e.params.filename);break;case"js":Ue(e.params.filename);break}}function Re(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}var ce=Re(),le=document.getElementById("powersync"),S=le.dataset.eventsUri;S.startsWith(":")&&(S=`${window.location.protocol}//${window.location.hostname}${S}`);var oe=le.dataset.eventsTopic,ue=new URL(S);ue.searchParams.append("topic",oe);var W=new EventSource(ue);W.onopen=e=>{console.log("eventSource open")};W.onerror=e=>{console.log("eventSource error")};W.onmessage=e=>{let t=JSON.parse(e.data);t.senderId!=ce&&(Z(t),se(t))};["change","click","input","keydown","keyup","pointerdown","pointermove","pointerup","popstate","pushState","replaceState","reset","scroll","submit","touchend","touchmove","touchstart"].forEach(e=>{window.addEventListener(e,t=>{Q(S,oe,ce,event)},!0)});G();})();
