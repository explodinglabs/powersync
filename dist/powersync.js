"use strict";(()=>{var W=Object.create;var x=Object.defineProperty;var Y=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var K=Object.getPrototypeOf,z=Object.prototype.hasOwnProperty;var p=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var F=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of B(t))!z.call(e,o)&&o!==n&&x(e,o,{get:()=>t[o],enumerable:!(r=Y(t,o))||r.enumerable});return e};var _=(e,t,n)=>(n=e!=null?W(K(e)):{},F(t||!e||!e.__esModule?x(n,"default",{value:e,enumerable:!0}):n,e));var S=p((Te,M)=>{c.notEqual=ee;c.notOk=te;c.equal=N;c.ok=c;M.exports=c;function N(e,t,n){c(e==t,n)}function ee(e,t,n){c(e!=t,n)}function te(e,t){c(!e,t)}function c(e,t){if(!e)throw new Error(t||"AssertionError")}});var A=p((Me,k)=>{k.exports=["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onmouseenter","onmouseleave","ontouchcancel","ontouchend","ontouchmove","ontouchstart","ondragstart","ondrag","ondragenter","ondragleave","ondragover","ondrop","ondragend","onkeydown","onkeypress","onkeyup","onunload","onabort","onerror","onresize","onscroll","onselect","onchange","onsubmit","onreset","onfocus","onblur","oninput","onanimationend","onanimationiteration","onanimationstart","oncontextmenu","onfocusin","onfocusout"]});var C=p((Se,I)=>{var L=A(),ne=L.length,re=1,oe=3,ae=8;I.exports=ie;function ie(e,t){var n=e.nodeType,r=e.nodeName;n===re&&se(e,t),(n===oe||n===ae)&&t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue),r==="INPUT"?le(e,t):r==="OPTION"?ce(e,t):r==="TEXTAREA"&&pe(e,t),ue(e,t)}function se(e,t){for(var n=t.attributes,r=e.attributes,o=null,i=null,s=null,a=null,u=null,v=r.length-1;v>=0;--v)u=r[v],a=u.name,o=u.namespaceURI,i=u.value,o?(a=u.localName||a,s=t.getAttributeNS(o,a),s!==i&&t.setAttributeNS(o,a,i)):t.hasAttribute(a)?(s=t.getAttribute(a),s!==i&&(i==="null"||i==="undefined"?t.removeAttribute(a):t.setAttribute(a,i))):t.setAttribute(a,i);for(var b=n.length-1;b>=0;--b)u=n[b],u.specified!==!1&&(a=u.name,o=u.namespaceURI,o?(a=u.localName||a,e.hasAttributeNS(o,a)||t.removeAttributeNS(o,a)):e.hasAttributeNS(null,a)||t.removeAttribute(a))}function ue(e,t){for(var n=0;n<ne;n++){var r=L[n];e[r]?t[r]=e[r]:t[r]&&(t[r]=void 0)}}function ce(e,t){g(e,t,"selected")}function le(e,t){var n=e.value,r=t.value;g(e,t,"checked"),g(e,t,"disabled"),e.indeterminate!==t.indeterminate&&(t.indeterminate=e.indeterminate),t.type!=="file"&&(n!==r&&(t.setAttribute("value",n),t.value=n),n==="null"&&(t.value="",t.removeAttribute("value")),e.hasAttributeNS(null,"value")?t.type==="range"&&(t.value=n):t.removeAttribute("value"))}function pe(e,t){var n=e.value;if(n!==t.value&&(t.value=n),t.firstChild&&t.firstChild.nodeValue!==n){if(n===""&&t.firstChild.nodeValue===t.placeholder)return;t.firstChild.nodeValue=n}}function g(e,t,n){e[n]!==t[n]&&(t[n]=e[n],e[n]?t.setAttribute(n,""):t.removeAttribute(n))}});var H=p((ke,V)=>{var E=S(),fe=C(),me=3;V.exports=he;function he(e,t,n){return E.equal(typeof e,"object","nanomorph: oldTree should be an object"),E.equal(typeof t,"object","nanomorph: newTree should be an object"),n&&n.childrenOnly?(O(t,e),e):(E.notEqual(t.nodeType,11,"nanomorph: newTree should have one root node (which is not a DocumentFragment)"),m(t,e))}function m(e,t){return t?e?e.isSameNode&&e.isSameNode(t)?t:e.tagName!==t.tagName||D(e)!==D(t)?e:(fe(e,t),O(e,t),t):null:e}function D(e){return e.dataset?e.dataset.nanomorphComponentId:void 0}function O(e,t){for(var n,r,o,i,s=0,a=0;n=t.childNodes[a],r=e.childNodes[a-s],!(!n&&!r);a++)if(!r)t.removeChild(n),a--;else if(!n)t.appendChild(r),s++;else if(P(r,n))o=m(r,n),o!==n&&(t.replaceChild(o,n),s++);else{i=null;for(var u=a;u<t.childNodes.length;u++)if(P(t.childNodes[u],r)){i=t.childNodes[u];break}i?(o=m(r,i),o!==i&&s++,t.insertBefore(o,n)):!r.id&&!n.id?(o=m(r,n),o!==n&&(t.replaceChild(o,n),s++)):(t.insertBefore(r,n),s++)}}function P(e,t){return e.id?e.id===t.id:e.isSameNode?e.isSameNode(t):e.tagName!==t.tagName?!1:e.type===me?e.nodeValue===t.nodeValue:!1}});var f={};function j(e,t){f[e]=!0,requestAnimationFrame(()=>{f[e]=!1}),t()}var G={change:e=>{e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))},click:e=>{e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))},input:(e,t)=>{e instanceof HTMLSelectElement?(e.value=t.inputValue,e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))):e instanceof HTMLElement&&e.isContentEditable?(e.textContent=t.inputValue,e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))):((e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)&&(e.value=t.inputValue),e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})))},keydown:(e,t)=>{e.dispatchEvent(new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:t.inputValue}))},keyup:e=>{e.dispatchEvent(new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,key:""}))},pointerdown:(e,t)=>{e.dispatchEvent(new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:t.pointer.x,clientY:t.pointer.y,pointerId:1,pointerType:"touch",isPrimary:!0}))},pointermove:(e,t)=>{e.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:t.pointer.x,clientY:t.pointer.y,pointerId:1,pointerType:"touch",isPrimary:!0}))},pointerup:(e,t)=>{e.dispatchEvent(new PointerEvent("pointerup",{bubbles:!0,cancelable:!0,clientX:t.pointer.x,clientY:t.pointer.y,pointerId:1,pointerType:"touch",isPrimary:!0}))},popstate:e=>{e.dispatchEvent(new PopStateEvent("popstate",{bubbles:!0,cancelable:!0,state:history.state}))},pushState:e=>{history.pushState({},"",window.location.href)},replaceState:e=>{history.replaceState({},"",window.location.href)},reset:e=>{e.dispatchEvent(new Event("reset",{bubbles:!0,cancelable:!0}))},scroll:(e,t)=>{e instanceof HTMLElement?e.scrollTop=t.scroll.y:e instanceof Document?document.documentElement.scrollTop=t.scroll.y:e instanceof Window&&e.scrollTo(t.scroll.x,t.scroll.y)},submit:e=>{e.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},touchend:e=>{e.dispatchEvent(new TouchEvent("touchend",{bubbles:!0,cancelable:!0,touches:[],targetTouches:[],changedTouches:[]}))},touchmove:e=>{e.dispatchEvent(new TouchEvent("touchmove",{bubbles:!0,cancelable:!0,touches:[],targetTouches:[],changedTouches:[]}))},touchstart:e=>{e.dispatchEvent(new TouchEvent("touchstart",{bubbles:!0,cancelable:!0,touches:[],targetTouches:[],changedTouches:[]}))}};function w({type:e,params:t}){let n=G[e];if(n){let r=window;t.selector&&(r=document.querySelector(t.selector)??window),j(e,()=>{n(r,t)})}}function Z(e,t,n){fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJtZXJjdXJlIjp7InB1Ymxpc2giOlsiKiJdfX0.PXwpfIGng6KObfZlcOXvcnWCJOWTFLtswGI5DZuWSK4"},body:new URLSearchParams({topic:t,data:JSON.stringify(n)})})}function Q(e){let t=[];for(;e.parentNode;){let n=0,r=0;for(let s=0;s<e.parentNode.children.length;s++){let a=e.parentNode.children[s];a.tagName===e.tagName&&(a===e&&(r=n),n++)}let o=e.tagName.toLowerCase(),i=n>1?`${o}:nth-of-type(${r+1})`:o;t.unshift(i),e=e.parentNode}return t.slice(1).join(" > ")}function T(e,t,n,r){if(r.target&&!f[r.type]){let o=r.target,i={senderId:n,type:r.type,params:{selector:Q(o),inputValue:o instanceof HTMLInputElement||o instanceof HTMLTextAreaElement?o.value:o instanceof HTMLElement&&o.isContentEditable?o.innerHTML.replace(/&nbsp;/g," "):o instanceof HTMLSelectElement?o.value:null,pointer:{x:r.clientX,y:r.clientY},scroll:{x:window.scrollX,y:window.scrollY}}};Z(e,t,i)}}var q=_(H()),h={};function d(){h={},document.querySelectorAll('link[rel="stylesheet"]').forEach(e=>{e instanceof HTMLLinkElement&&e.href&&(h[new URL(e.href,location.origin).pathname]=e)})}function ve(e){for(let t in h)t==e.replace(/tmp\./,"")&&(h[t].href=`${e}?v=${Date.now()}`)}function be(e){document.querySelectorAll("script[src]").forEach(t=>{if(new URL(t.src,location.origin).pathname===e.replace(/tmp\./,"")){let r=document.createElement("script");Array.from(t.attributes).forEach(o=>{r.setAttribute(o.name,o.value)}),r.src=`${e}?v=${Date.now()}`,t.replaceWith(r)}})}async function ge(e){let t=await fetch(`${e}?v=${Date.now()}`).then(o=>o.text()),r=new DOMParser().parseFromString(t,"text/html");(0,q.default)(document.documentElement,r.documentElement),d()}function R(e){switch(e.type){case"css":ve(e.params.filename);break;case"html":ge(e.params.filename);break;case"js":be(e.params.filename);break}}function Ee(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}var X=Ee(),U=document.getElementById("powersync"),l=U.dataset.eventsUri;l.startsWith(":")&&(l=`${window.location.protocol}//${window.location.hostname}${l}`);var J=U.dataset.eventsTopic,$=new URL(l);$.searchParams.append("topic",J);var y=new EventSource($);y.onopen=e=>{console.log("eventSource open")};y.onerror=e=>{console.log("eventSource error")};y.onmessage=e=>{let t=JSON.parse(e.data);t.senderId!=X&&(w(t),R(t))};["change","click","input","keydown","keyup","pointerdown","pointermove","pointerup","popstate","pushState","replaceState","reset","scroll","submit","touchend","touchmove","touchstart"].forEach(e=>{window.addEventListener(e,t=>{T(l,J,X,event)},!0)});d();})();
