"use strict";(()=>{var U={};function me(e,t){U[e]=!0,requestAnimationFrame(()=>{U[e]=!1}),t()}var ge={change:(e,t)=>{e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))},click:e=>{e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))},input:(e,t)=>{e instanceof HTMLSelectElement?(e.value=t.inputValue,e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))):e instanceof HTMLElement&&e.isContentEditable?(e.textContent=t.inputValue,e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))):((e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)&&(e.value=t.inputValue),e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})))},keydown:(e,t)=>{e.dispatchEvent(new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:t.inputValue}))},keyup:e=>{e.dispatchEvent(new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,key:""}))},pointerdown:(e,t)=>{e.dispatchEvent(new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:t.pointer.x,clientY:t.pointer.y,pointerId:1,pointerType:"touch",isPrimary:!0}))},pointermove:(e,t)=>{e.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:t.pointer.x,clientY:t.pointer.y,pointerId:1,pointerType:"touch",isPrimary:!0}))},pointerup:(e,t)=>{e.dispatchEvent(new PointerEvent("pointerup",{bubbles:!0,cancelable:!0,clientX:t.pointer.x,clientY:t.pointer.y,pointerId:1,pointerType:"touch",isPrimary:!0}))},popstate:e=>{e.dispatchEvent(new PopStateEvent("popstate",{bubbles:!0,cancelable:!0,state:history.state}))},pushState:()=>{history.pushState({},"",window.location.href)},replaceState:()=>{history.replaceState({},"",window.location.href)},reset:e=>{e.dispatchEvent(new Event("reset",{bubbles:!0,cancelable:!0}))},scroll:(e,t)=>{e instanceof HTMLElement?e.scrollTop=t.scroll.y:e instanceof Document?document.documentElement.scrollTop=t.scroll.y:e instanceof Window&&e.scrollTo(t.scroll.x,t.scroll.y)},submit:e=>{e.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},touchend:e=>{e.dispatchEvent(new TouchEvent("touchend",{bubbles:!0,cancelable:!0,touches:[],targetTouches:[],changedTouches:[]}))},touchmove:e=>{e.dispatchEvent(new TouchEvent("touchmove",{bubbles:!0,cancelable:!0,touches:[],targetTouches:[],changedTouches:[]}))},touchstart:e=>{e.dispatchEvent(new TouchEvent("touchstart",{bubbles:!0,cancelable:!0,touches:[],targetTouches:[],changedTouches:[]}))}};function Z({type:e,params:t}){let a=ge[e];if(a){let r=window;t.selector&&(r=document.querySelector(t.selector)??window),me(e,()=>{a(r,t)})}}function Te(e,t,a){fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJtZXJjdXJlIjp7InB1Ymxpc2giOlsiKiJdfX0.PXwpfIGng6KObfZlcOXvcnWCJOWTFLtswGI5DZuWSK4"},body:new URLSearchParams({topic:t,data:JSON.stringify(a)})})}function we(e){let t=[];for(;e.parentNode;){let a=0,r=0;for(let u=0;u<e.parentNode.children.length;u++){let v=e.parentNode.children[u];v.tagName===e.tagName&&(v===e&&(r=a),a++)}let n=e.tagName.toLowerCase(),l=a>1?`${n}:nth-of-type(${r+1})`:n;t.unshift(l),e=e.parentNode}return t.slice(1).join(" > ")}function Q(e,t,a,r){if(r.target&&!U[r.type]){let n=r.target,l={senderId:a,type:r.type,params:{selector:we(n),inputValue:n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement?n.value:n instanceof HTMLElement&&n.isContentEditable?n.innerHTML.replace(/&nbsp;/g," "):n instanceof HTMLSelectElement?n.value:null,pointer:{x:r.clientX,y:r.clientY},scroll:{x:window.scrollX,y:window.scrollY}}};Te(e,t,l)}}var ee=11;function xe(e,t){var a=t.attributes,r,n,l,u,v;if(!(t.nodeType===ee||e.nodeType===ee)){for(var E=a.length-1;E>=0;E--)r=a[E],n=r.name,l=r.namespaceURI,u=r.value,l?(n=r.localName||n,v=e.getAttributeNS(l,n),v!==u&&(r.prefix==="xmlns"&&(n=r.name),e.setAttributeNS(l,n,u))):(v=e.getAttribute(n),v!==u&&e.setAttribute(n,u));for(var A=e.attributes,y=A.length-1;y>=0;y--)r=A[y],n=r.name,l=r.namespaceURI,l?(n=r.localName||n,t.hasAttributeNS(l,n)||e.removeAttributeNS(l,n)):t.hasAttribute(n)||e.removeAttribute(n)}}var C,Ee="http://www.w3.org/1999/xhtml",p=typeof document>"u"?void 0:document,ye=!!p&&"content"in p.createElement("template"),Me=!!p&&p.createRange&&"createContextualFragment"in p.createRange();function Se(e){var t=p.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}function Ae(e){C||(C=p.createRange(),C.selectNode(p.body));var t=C.createContextualFragment(e);return t.childNodes[0]}function Le(e){var t=p.createElement("body");return t.innerHTML=e,t.childNodes[0]}function Ne(e){return e=e.trim(),ye?Se(e):Me?Ae(e):Le(e)}function R(e,t){var a=e.nodeName,r=t.nodeName,n,l;return a===r?!0:(n=a.charCodeAt(0),l=r.charCodeAt(0),n<=90&&l>=97?a===r.toUpperCase():l<=90&&n>=97?r===a.toUpperCase():!1)}function He(e,t){return!t||t===Ee?p.createElement(e):p.createElementNS(t,e)}function Oe(e,t){for(var a=e.firstChild;a;){var r=a.nextSibling;t.appendChild(a),a=r}return t}function K(e,t,a){e[a]!==t[a]&&(e[a]=t[a],e[a]?e.setAttribute(a,""):e.removeAttribute(a))}var te={OPTION:function(e,t){var a=e.parentNode;if(a){var r=a.nodeName.toUpperCase();r==="OPTGROUP"&&(a=a.parentNode,r=a&&a.nodeName.toUpperCase()),r==="SELECT"&&!a.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),a.selectedIndex=-1)}K(e,t,"selected")},INPUT:function(e,t){K(e,t,"checked"),K(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var a=t.value;e.value!==a&&(e.value=a);var r=e.firstChild;if(r){var n=r.nodeValue;if(n==a||!a&&n==e.placeholder)return;r.nodeValue=a}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var a=-1,r=0,n=e.firstChild,l,u;n;)if(u=n.nodeName&&n.nodeName.toUpperCase(),u==="OPTGROUP")l=n,n=l.firstChild;else{if(u==="OPTION"){if(n.hasAttribute("selected")){a=r;break}r++}n=n.nextSibling,!n&&l&&(n=l.nextSibling,l=null)}e.selectedIndex=a}}},M=1,ne=11,ae=3,re=8;function g(){}function De(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}function Ie(e){return function(a,r,n){if(n||(n={}),typeof r=="string")if(a.nodeName==="#document"||a.nodeName==="HTML"||a.nodeName==="BODY"){var l=r;r=p.createElement("html"),r.innerHTML=l}else r=Ne(r);else r.nodeType===ne&&(r=r.firstElementChild);var u=n.getNodeKey||De,v=n.onBeforeNodeAdded||g,E=n.onNodeAdded||g,A=n.onBeforeElUpdated||g,y=n.onElUpdated||g,de=n.onBeforeNodeDiscarded||g,L=n.onNodeDiscarded||g,fe=n.onBeforeElChildrenUpdated||g,pe=n.skipFromChildren||g,Y=n.addChild||function(i,s){return i.appendChild(s)},X=n.childrenOnly===!0,T=Object.create(null),N=[];function H(i){N.push(i)}function z(i,s){if(i.nodeType===M)for(var d=i.firstChild;d;){var c=void 0;s&&(c=u(d))?H(c):(L(d),d.firstChild&&z(d,s)),d=d.nextSibling}}function O(i,s,d){de(i)!==!1&&(s&&s.removeChild(i),L(i),z(i,d))}function _(i){if(i.nodeType===M||i.nodeType===ne)for(var s=i.firstChild;s;){var d=u(s);d&&(T[d]=s),_(s),s=s.nextSibling}}_(a);function B(i){E(i);for(var s=i.firstChild;s;){var d=s.nextSibling,c=u(s);if(c){var o=T[c];o&&R(s,o)?(s.parentNode.replaceChild(o,s),D(o,s)):B(s)}else B(s);s=d}}function ve(i,s,d){for(;s;){var c=s.nextSibling;(d=u(s))?H(d):O(s,i,!0),s=c}}function D(i,s,d){var c=u(s);if(c&&delete T[c],!d){var o=A(i,s);if(o===!1||(o instanceof HTMLElement&&(i=o,_(i)),e(i,s),y(i),fe(i,s)===!1))return}i.nodeName!=="TEXTAREA"?he(i,s):te.TEXTAREA(i,s)}function he(i,s){var d=pe(i,s),c=s.firstChild,o=i.firstChild,w,h,x,P,b;e:for(;c;){for(P=c.nextSibling,w=u(c);!d&&o;){if(x=o.nextSibling,c.isSameNode&&c.isSameNode(o)){c=P,o=x;continue e}h=u(o);var k=o.nodeType,m=void 0;if(k===c.nodeType&&(k===M?(w?w!==h&&((b=T[w])?x===b?m=!1:(i.insertBefore(b,o),h?H(h):O(o,i,!0),o=b,h=u(o)):m=!1):h&&(m=!1),m=m!==!1&&R(o,c),m&&D(o,c)):(k===ae||k==re)&&(m=!0,o.nodeValue!==c.nodeValue&&(o.nodeValue=c.nodeValue))),m){c=P,o=x;continue e}h?H(h):O(o,i,!0),o=x}if(w&&(b=T[w])&&R(b,c))d||Y(i,b),D(b,c);else{var F=v(c);F!==!1&&(F&&(c=F),c.actualize&&(c=c.actualize(i.ownerDocument||p)),Y(i,c),B(c))}c=P,o=x}ve(i,o,h);var q=te[i.nodeName];q&&q(i,s)}var f=a,I=f.nodeType,j=r.nodeType;if(!X){if(I===M)j===M?R(a,r)||(L(a),f=Oe(a,He(r.nodeName,r.namespaceURI))):f=r;else if(I===ae||I===re){if(j===I)return f.nodeValue!==r.nodeValue&&(f.nodeValue=r.nodeValue),f;f=r}}if(f===r)L(a);else{if(r.isSameNode&&r.isSameNode(f))return;if(D(f,r,X),N)for(var $=0,be=N.length;$<be;$++){var J=T[N[$]];J&&O(J,J.parentNode,!1)}}return!X&&f!==a&&a.parentNode&&(f.actualize&&(f=f.actualize(a.ownerDocument||p)),a.parentNode.replaceChild(f,a)),f}}var Pe=Ie(xe),ie=Pe;var V={};function G(){V={},document.querySelectorAll('link[rel="stylesheet"]').forEach(e=>{e instanceof HTMLLinkElement&&e.href&&(V[new URL(e.href,location.origin).pathname]=e)})}function ke(){for(let e in V)V[e].href=`${e}?v=${Date.now()}`}async function Ue(e){let t=await fetch(`${e}?v=${Date.now()}`).then(n=>n.text()),r=new DOMParser().parseFromString(t,"text/html");ie(document.documentElement,r.documentElement,{onBeforeElUpdated:(n,l)=>{if(n.hasAttribute("data-component"))return!1;if(n.hasAttribute("id"))switch(n.tagName){case"INPUT":l.value=n.value,l.checked=n.checked;break;case"TEXTAREA":l.value=n.value;break;case"SELECT":l.value=n.value;break;case"OPTION":l.selected=n.selected;break}return document.activeElement===n?(setTimeout(()=>n.focus(),0),n.tagName==="BODY"):!0}}),G()}function Ce(){document.querySelectorAll("script[src]").forEach(e=>{let t=document.createElement("script");Array.from(e.attributes).forEach(a=>{t.setAttribute(a.name,a.value)}),t.src=`${e.src.split("?")[0]}?v=${Date.now()}`,e.replaceWith(t)})}function se(e){switch(e.type){case"css":ke();break;case"html":Ue(e.params.filename);break;case"js":Ce();break}}function Re(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}var ce=Re(),le=document.getElementById("powersync"),S=le.dataset.eventsUri;S.startsWith(":")&&(S=`${window.location.protocol}//${window.location.hostname}${S}`);var oe=le.dataset.eventsTopic,ue=new URL(S);ue.searchParams.append("topic",oe);var W=new EventSource(ue);W.onopen=e=>{console.log("eventSource open")};W.onerror=e=>{console.log("eventSource error")};W.onmessage=e=>{let t=JSON.parse(e.data);t.senderId!=ce&&(Z(t),se(t))};["change","click","input","keydown","keyup","pointerdown","pointermove","pointerup","popstate","pushState","replaceState","reset","scroll","submit","touchend","touchmove","touchstart"].forEach(e=>{window.addEventListener(e,t=>{Q(S,oe,ce,t)},!0)});G();})();
