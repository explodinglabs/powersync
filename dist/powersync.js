"use strict";(()=>{var d={};function D(e,t){d[e]=!0,requestAnimationFrame(()=>{d[e]=!1}),t()}var A={change:e=>{e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))},click:e=>{e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))},input:(e,t)=>{e instanceof HTMLSelectElement?(e.value=t.inputValue,e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))):e instanceof HTMLElement&&e.isContentEditable?(e.textContent=t.inputValue,e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))):((e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)&&(e.value=t.inputValue),e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})))},keydown:(e,t)=>{e.dispatchEvent(new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:t.inputValue}))},keyup:e=>{e.dispatchEvent(new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,key:""}))},pointerdown:(e,t)=>{e.dispatchEvent(new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:t.pointer.x,clientY:t.pointer.y,pointerId:1,pointerType:"touch",isPrimary:!0}))},pointermove:(e,t)=>{e.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:t.pointer.x,clientY:t.pointer.y,pointerId:1,pointerType:"touch",isPrimary:!0}))},pointerup:(e,t)=>{e.dispatchEvent(new PointerEvent("pointerup",{bubbles:!0,cancelable:!0,clientX:t.pointer.x,clientY:t.pointer.y,pointerId:1,pointerType:"touch",isPrimary:!0}))},popstate:e=>{e.dispatchEvent(new PopStateEvent("popstate",{bubbles:!0,cancelable:!0,state:history.state}))},pushState:e=>{history.pushState({},"",window.location.href)},replaceState:e=>{history.replaceState({},"",window.location.href)},reset:e=>{e.dispatchEvent(new Event("reset",{bubbles:!0,cancelable:!0}))},scroll:(e,t)=>{e instanceof HTMLElement?e.scrollTop=t.scroll.y:e instanceof Document?document.documentElement.scrollTop=t.scroll.y:e instanceof Window&&e.scrollTo(t.scroll.x,t.scroll.y)},submit:e=>{e.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},touchend:e=>{e.dispatchEvent(new TouchEvent("touchend",{bubbles:!0,cancelable:!0,touches:[],targetTouches:[],changedTouches:[]}))},touchmove:e=>{e.dispatchEvent(new TouchEvent("touchmove",{bubbles:!0,cancelable:!0,touches:[],targetTouches:[],changedTouches:[]}))},touchstart:e=>{e.dispatchEvent(new TouchEvent("touchstart",{bubbles:!0,cancelable:!0,touches:[],targetTouches:[],changedTouches:[]}))}};function b({type:e,params:t}){let n=A[e];if(n){let o=window;t.selector&&(o=document.querySelector(t.selector)??window),D(e,()=>{n(o,t)})}}function H(e,t,n){fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJtZXJjdXJlIjp7InB1Ymxpc2giOlsiKiJdfX0.PXwpfIGng6KObfZlcOXvcnWCJOWTFLtswGI5DZuWSK4"},body:new URLSearchParams({topic:t,data:JSON.stringify(n)})})}function C(e){let t=[];for(;e.parentNode;){let n=0,o=0;for(let c=0;c<e.parentNode.children.length;c++){let l=e.parentNode.children[c];l.tagName===e.tagName&&(l===e&&(o=n),n++)}let r=e.tagName.toLowerCase(),s=n>1?`${r}:nth-of-type(${o+1})`:r;t.unshift(s),e=e.parentNode}return t.slice(1).join(" > ")}function g(e,t,n){["change","click","input","keydown","keyup","pointerdown","pointermove","pointerup","popstate","pushState","replaceState","reset","scroll","submit","touchend","touchmove","touchstart"].forEach(o=>{window.addEventListener(o,r=>{if(!d[r.type]&&r.target){let s=r.target,c={senderId:n,type:r.type,params:{selector:C(s),inputValue:s instanceof HTMLInputElement||s instanceof HTMLTextAreaElement?s.value:s instanceof HTMLElement&&s.isContentEditable?s.innerHTML.replace(/&nbsp;/g," "):s instanceof HTMLSelectElement?s.value:null,pointer:{x:r.clientX,y:r.clientY},scroll:{x:window.scrollX,y:window.scrollY}}};H(e,t,c)}},!0)})}function m(e,t){if(!e||!t){console.error("Invalid nodes provided for diffing and applying");return}if(e.nodeType!==t.nodeType){if(e.nodeType===Node.ELEMENT_NODE&&t.nodeType===Node.ELEMENT_NODE&&e.nodeType!==t.nodeType){e.nodeType===Node.ELEMENT_NODE&&t.nodeType===Node.ELEMENT_NODE&&e.replaceWith(t);return}return}if(e.nodeType===Node.ELEMENT_NODE){let n=e,o=t,r=n.attributes,s=o.attributes,c={};r&&s&&(Array.from(s).forEach(i=>{n.getAttribute(i.name)!==i.value&&(c[i.name]=i.value)}),Array.from(r).forEach(i=>{o.hasAttribute(i.name)||(c[i.name]=null)}),Object.entries(c).forEach(([i,a])=>{a===null?n.removeAttribute(i):n.setAttribute(i,a)}));let l=n.childNodes,E=o.childNodes,S=Math.max(l.length,E.length);for(let i=0;i<S;i++){let a=l[i],p=E[i];a&&p?m(a,p):a?n.removeChild(a):p&&n.appendChild(p)}}else e.nodeType===Node.TEXT_NODE&&e.textContent!==t.textContent&&(e.textContent=t.textContent)}var h={};function v(){h={},document.querySelectorAll('link[rel="stylesheet"]').forEach(e=>{e instanceof HTMLLinkElement&&e.href&&(h[new URL(e.href,location.origin).pathname]=e)})}function I(e){for(let t in h)t==e.replace(/tmp\./,"")&&(h[t].href=`${e}?v=${Date.now()}`)}function k(e){document.querySelectorAll("script[src]").forEach(t=>{if(new URL(t.src,location.origin).pathname===e.replace(/tmp\./,"")){let o=document.createElement("script");Array.from(t.attributes).forEach(r=>{o.setAttribute(r.name,r.value)}),o.src=`${e}?v=${Date.now()}`,t.replaceWith(o)}})}async function O(e){let t=await fetch(`${e}?v=${Date.now()}`).then(o=>o.text()),n=document.createElement("html");n.innerHTML=t,m(document.documentElement,n),v()}function w(){document.addEventListener("DOMContentLoaded",()=>{v()})}function y(e){switch(e.type){case"css":I(e.params.filename);break;case"html":O(e.params.filename);break;case"js":k(e.params.filename);break}}function P(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}var x=P(),T=document.getElementById("powersync"),u=T.dataset.eventsUri;u.startsWith(":")&&(u=`${window.location.protocol}//${window.location.hostname}${u}`);var M=T.dataset.eventsTopic,L=new URL(u);L.searchParams.append("topic",M);var f=new EventSource(L);f.onopen=e=>{console.log("eventSource open")};f.onerror=e=>{console.log("eventSource error")};w();f.onmessage=e=>{let t=JSON.parse(e.data);t.senderId!=x&&(b(t),y(t))};g(u,M,x);})();
